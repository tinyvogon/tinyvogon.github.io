---
layout: post 
title:  "SP21 - Blog 7 - Create Cloudwatch Alarms for Instance Availability Checks"
date:   2021-04-14 18:34:18 -0700
categories: blog
---


For our senior project, my group are hosting our website on a t2.micro EC2 instance. Due to the heavy workload of python processing, the server's CPU spikes sometimes and remains unresponsive until it gets rebooted. That is the reason why I've decided to set a Cloudwatch Alarm to reboot the instance whenever the availability checks fails. At first, I thought I would have to create a AWS Lambda function to reboot the instance whenever it receives a SNS notification from the Cloudwatch Alarm. Then I found out that Cloudwatch Alarms for EC2 function has a built-in Alarm Action, which can reboot the instance when the availability checks fails. This is how to set it up:


1. First, go to the EC2 Instances tab. Click on the instance, and go to *Status Checks* tab. There's a button that says *Action*. Click on it and go to **Create status check alarm.**

    ![sp-blog7-0](/assets/sp-blog7-0.png){:class="img-responsive"}


2. Make sure you are in the *Create alarm* mode and not *Edit alarm*. Scroll down to *Alarm action* and choose **Reboot** to reboot the instance when the an availability check fails.

    ![sp-blog7-1](/assets/sp-blog7-1.PNG){:class="img-responsive"}


3. Make sure the *Alarm thresholds* fields are similar to this. You can choose to shorten or lengthen the *Period* it takes to issue the alarm. Scroll down and click **Create** to create the alarm.

    ![sp-blog7-2](/assets/sp-blog7-2.PNG){:class="img-responsive"}


4. Now go to *Cloudwatch* to see if your alarm has been created. Initially, the alarm might stay *Insufficient data* but it will switch to *OK* after a few minutes. Once you have this alarm working, whenever availability checks of your server fails, it is going to reboot the EC2 instance.
    ![sp-blog7-3](/assets/sp-blog7-3.PNG){:class="img-responsive"}

