---
layout: post 
title:  "SP21 - Blog 10 - Create a failover records in Route 53"
date:   2021-05-05 18:34:18 -0700
categories: blog
---


To handle the traffic coming to our websites and EC2 instances, sometimes we need two servers with the same sites and resources. Usually, we can handle managing the traffic by creating a Load Balancer and letting it handle on its own. However, there is also another way to handle heavy traffic and redirect traffic to a backup instance once an instance fails. It is creating failover records and health checks in Route 53.

1. First, you have to create a health check that can be associated with the records. Go to Route 53 page and click on Health check.

2. Create a health check to the IP or the domain of the site. In my example, I created a HTTPS health check to the primary EC2 instance that hosts the site. As you can see, the EC2 instance of IP *xxx.xxx.xxx.157* is healthy and the site is available on that instance.

    ![sp-blog10-0](/assets/sp-blog10-0.PNG){:class="img-responsive"}


2. Next, go to the hosted zone of the site and create a new record/ edit the old record. In my example, I will use the *xxx.xxx.xxx.157* as the primary IP of the site. Choose **Failover** for routing policy, **Primary** for Failover Record Type, and choose the health check we previously set up. Also, type a distinct record ID to differentiate this record from the secondary record.

    ![sp-blog10-1](/assets/sp-blog10-1.PNG){:class="img-responsive"}


3. After we set up the primary record, proceed to set up the secondary record for the site. Here I am creating a new record with the same host name, but the IP address is of a backup EC2 instance with the same resources *xxx.xxx.xxx.156*. Choose **Failover** for routing policy, **Secondary** for Failover Record Type, but don't associate a health check to this secondary record. Type a record ID that's different from that of the primary record.

    ![sp-blog10-2](/assets/sp-blog10-2.PNG){:class="img-responsive"}

4. Now we have 2 records with the same hostname, but pointing to different IPs. As *xxx.xxx.xxx.157* is the primary IP for the site, the traffic will keep going to that IP until the health check returns failure, only then traffic will be redirected to the secondary IP.

    ![sp-blog10-3](/assets/sp-blog10-3.PNG){:class="img-responsive"}